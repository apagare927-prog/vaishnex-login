<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vaishnex Login</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<!-- REAL Country Selector (200+ countries) -->
<link rel="stylesheet"
 href="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/css/intlTelInput.css"/>
<script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/intlTelInput.min.js"></script>

<style>
body{
  margin:0;height:100vh;
  background:radial-gradient(circle at top,#0a1a2f,#000);
  display:flex;align-items:center;justify-content:center;
  font-family:Arial;color:#fff
}
.card{
  width:92%;max-width:380px;
  background:#0f172a;
  padding:26px;border-radius:22px;
  text-align:center
}

/* LOGO SAME */
.logo-ring{
  width:120px;height:120px;
  border-radius:50%;
  border:3px solid #3b82f6;
  display:flex;align-items:center;justify-content:center;
  margin:0 auto 15px;
  animation:glowPulse 1.6s ease-in-out infinite
}
@keyframes glowPulse{
  0%,100%{box-shadow:0 0 25px #3b82f6}
  50%{box-shadow:0 0 70px #3b82f6}
}

input,button{
  width:100%;padding:14px;
  margin-top:10px;border-radius:12px;
  border:none;font-size:15px
}
input{background:#020617;color:#fff}
input.error{border:2px solid red}
button{background:#3b82f6;color:#fff;cursor:pointer}
.hidden{display:none}
.error-text{color:#f87171;font-size:14px;margin-top:6px}
.timer{color:#94a3b8;margin-top:8px}
</style>
</head>

<body>
<div class="card">

<div class="logo-ring"><b>VAISHNEX</b></div>

<h3>Login</h3>

<!-- SINGLE INPUT -->
<input id="loginInput" placeholder="Email or Mobile number">
<div id="error" class="error-text hidden"></div>

<!-- OTP -->
<div id="otpBox" class="hidden">
  <input id="otpInput" placeholder="Enter OTP">
</div>

<button id="sendBtn" onclick="handleSend()">Send OTP</button>

<div id="timer" class="timer hidden"></div>
<button id="resendBtn" class="hidden" onclick="resendOTP()">Resend OTP</button>

<div id="recaptcha-container"></div>
</div>

<script>
/* FIREBASE CONFIG */
firebase.initializeApp({
  apiKey:"YOUR_API_KEY",
  authDomain:"YOUR_PROJECT.firebaseapp.com",
  projectId:"YOUR_PROJECT_ID",
  appId:"YOUR_APP_ID"
});
const auth=firebase.auth();

const input=document.getElementById("loginInput");
const errorBox=document.getElementById("error");
const otpBox=document.getElementById("otpBox");
const timerBox=document.getElementById("timer");
const resendBtn=document.getElementById("resendBtn");

let confirmationResult;
let iti;
let timer;

/* INIT REAL COUNTRY PICKER */
iti=window.intlTelInput(input,{
  separateDialCode:true,
  initialCountry:"in",
  utilsScript:
 "https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/utils.js"
});

/* Detect input */
input.addEventListener("input",()=>{
  clearError();
  const val=input.value.trim();
  if(/^[0-9+]/.test(val)){
    iti.showDropdown();
  }else{
    iti.hideDropdown();
  }
});

/* Recaptcha */
window.recaptchaVerifier=
 new firebase.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible"});

/* MAIN */
function handleSend(){
  clearError();
  const val=input.value.trim();
  if(!val)return showError("Field empty");

  if(val.includes("@")){
    showError("Email login next step (ready)");
    return;
  }

  if(!iti.isValidNumber()){
    return showError("Invalid mobile number");
  }

  firebase.auth()
   .signInWithPhoneNumber(iti.getNumber(),window.recaptchaVerifier)
   .then(res=>{
     confirmationResult=res;
     otpBox.classList.remove("hidden");
     startTimer();
   })
   .catch(e=>showError(e.message));
}

/* TIMER */
function startTimer(){
  let t=30;
  resendBtn.classList.add("hidden");
  timerBox.classList.remove("hidden");
  timerBox.innerText=`Resend OTP in ${t}s`;
  timer=setInterval(()=>{
    t--;
    timerBox.innerText=`Resend OTP in ${t}s`;
    if(t<=0){
      clearInterval(timer);
      timerBox.classList.add("hidden");
      resendBtn.classList.remove("hidden");
    }
  },1000);
}

function resendOTP(){
  handleSend();
}

function showError(msg){
  input.classList.add("error");
  errorBox.innerText=msg;
  errorBox.classList.remove("hidden");
}
function clearError(){
  input.classList.remove("error");
  errorBox.classList.add("hidden");
}
</script>

</body>
</html>
